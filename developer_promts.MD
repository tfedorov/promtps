## Define Your Role & Expertise Level

- I am a Senior Scala Big Data Developer working on large-scale distributed data processing.
- Explain like I'm a junior developer.
- Provide an advanced technical breakdown.
- I am a Senior Scala Big Data Developer want to generate unit tests for the method.
- As a Big Data Architect, I design distributed data pipelines. Explain how to build a scalable real-time streaming architecture using ...

## Set the Response Format

- Provide code first, then explain it step by step.
- Explain the trade-offs of using ...
- Paint design diagram for solution
- Provide plantuml component diagram for solution. Use sprites spark/java/hadoop for corresponding elements.
- Summarize the key points in bullet points.
- Describe in MD format provide pure code with no formatting.

## Use Real-World Context
- I am using Spark 3.4, Scala 2.12, and Apache Iceberg



## Define Your Role & Expertise Level

- I am a Senior Scala Big Data Developer working on large-scale distributed data processing.
- Explain like I'm a junior developer.
- Provide an advanced technical breakdown.
- As a Big Data Architect, I design distributed data pipelines. Explain how to build a scalable real-time streaming architecture using ...

## Unit testing
### Thoughtbots
- I am a Senior Scala Big Data Developer want to generate unit tests for the method. 
  Follow Thoughtbot's best practices for writing clean, readable, and maintainable tests.

Requirements:

- Use Scalatest as the testing framework.
- Follow the AAA pattern (Arrange, Act, Assert) for clarity.
- Keep tests small, independent, and fast by avoiding unnecessary external dependencies.
- Try to not Use mocks/stubs (e.g., Mockito or ScalaMock).
- Ensure edge cases and error handling are covered.
- Provide meaningful test names that describe the behavior

### Spark tests
- Use spark.implicits, use spark builtin functions.

## Format & Style
### Format
- Provide code first, then explain it step by step.
- Provide gradle kotlin code with rerquired dependencies.
- Explain the trade-offs of using ...
- Paint design diagram for solution
- Provide plantuml component diagram for solution. Use sprites spark/java/hadoop for corresponding elements.
- Describe in MD format provide pure code with no formatting.

### Style
- Rewrite this to be shorter and clearer: [paste text].
- Summarize this in one paragraph: [paste long text].
- Turn this into bullet points: [paste text]."
- Summarize the key points in bullet points
- Reword this in plain English: [paste technical explanation]
- Turn this into active voice: [paste text]
- Rewrite this so the subject does the action, not the other way around: [paste text]

### Chat message
- According to the issue. I need to write a chat message with explantation.

## Use Real-World Context
- I am using Spark 3.4, Scala 2.12, and Apache Iceberg. I use Gradle as a build tool.
- Generates gradle for spark/scala data pipeline. It should has no modules, use plugins: idea,scala, shadow Jar


